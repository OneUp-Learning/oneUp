<!DOCTYPE html>
<html lang="en">
   <head>
      {% include 'scripts.html' %}
   </head>
      <script>
         $( document ).ready(function(){
          var rollDate = $('#rollDate').bootstrapMaterialDatePicker({
            weekStart: 0, format: 'YYYY-MM-DD', time:false, clearButton:false, nowButton: true
          });
         
         });
         
         $(function(){
        	    $("#markPresent").click(function () {
        	          $('.checkbox').prop("checked", true);
        	          $('input[name=present[]]').prop("value", true);
        	          
        	    });
        	});
         
         $(function(){
     	    $("#unmarkPresent").click(function () {
     	         $('.checkbox').prop("checked", false);
     	         $('input[name=present[]]').prop("value", false);
     	    });
     	});
         
         function submitButton(){
      	    	validateCheckBox();
      	    	document.getElementById('rollForm').submit();
      	    }
         
         function validateCheckBox(){
             var checkBoxes = document.getElementsByName('checkbox');
                 for (var i = 0; i < checkBoxes.length; i++) {
                	 var id = checkBoxes[i].id;
                     if ( checkBoxes[i].checked ==  true) {
                    	 document.getElementById(id+"_hidden").value = true;
                     }else{
                    	 document.getElementById(id+"_hidden").value = false;
                     }
                 }
                 console.log("ran");
             }
      </script>
   <body>
      {% include 'heading.html' %}
      <main>
         <div class="row center-align">
            <div class="col s12">
               <h3>Student Attendance</h3>
            </div>
         </div>
         <div class="row">
            <div class="col s12 m10 offset-m1">
            <form name="question" enctype="multipart/form-data" action="/oneUp/instructors/studentAttendance" method="POST">
	            {% csrf_token %}
	            <div class="input-field col s4">
	            <div class="col s12">
                              <label for="rollDate">Current Date</label> 
                              <input onchange="this.form.submit()" type="text" class="datepicker-from" name="rollDate" value="{{rollDate}}" id="rollDate">
                           </div>
				</div>
			</form>
			<br/>
               <div class="row right-align">
                  <div class="col s8">
                     <a type="button" class="waves-effect waves-light btn" id="markPresent">Mark All Present</a>  
                     <a class="waves-effect waves-light btn" id="unmarkPresent">Unmark All Present</a>
                     <button id="save" onclick="submitButton()" class="waves-effect waves-light btn">Save</button>                                                          
                  </div>
               </div>
               
               <div class="card-panel">
               <form action="/oneUp/instructors/studentAttendance"  id="rollForm" method="POST">
               {% csrf_token %}
                  <table id="tableAttendance">
                     <thead>
                        <tr>
                        <th></th>
                        <th>Present</th>
                           <th>Name</th>
                        </tr>
                     </thead>
                     <tbody>
                        {% for student_ID, student_Avatars, student_Names, isPresent in class %}
                        <tr>
                           <td><a><img class="circle" width="25px" height="25px" src="{{student_Avatars}}"></a></td>
                           <td>
                           {% if isPresent == "true" %}
                           <input class="checkbox" name="checkbox" type="checkbox" id="{{student_ID}}" style="padding:0;" checked/>
                           {% else %}
                           <input class="checkbox" name="checkbox" type="checkbox" id="{{student_ID}}" style="padding:0;" />
                           {% endif %}	
                           
                           <label for="{{student_ID}}"></label>
                               <input class="hidden" type="hidden" id="{{student_ID}}_hidden" name="present[]" value={{isPresent}}>
                           </td>
                           <td>{{student_Names}}</td>
                        </tr>
                        {% empty %}
                        <tr>
                           <td class="center-align" colspan="4"><i>No Students Created</i></td>
                        </tr>
                        {% endfor %}
                     </tbody>
                  </table>
                  	<input class="hidden" type="hidden" class="datepicker-from" name="rollDate" value={{rollDate}} id="rollDate">
                  </form>
				 </div>
               </div>
            </div>
         </div>
      </main>
      {% include 'footer.html' %}
   </body>
</html>