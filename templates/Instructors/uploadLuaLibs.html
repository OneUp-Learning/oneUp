<!DOCTYPE html>
<html lang="en">
<head>

   {% include 'scripts.html' %}
   
   <title> Lua Library Upload </title>
 
</head>
<body>
	<div id="page-wrapper">

         {% include 'heading.html' %}
 
		<div class="frame" id="grad" align="center">
        <div class="container">
        <div class="row">
        <div class="12u">
        	<h1>Lua  Libraries</h1>
		</div>
		</div>
		<br />
		
		<div align="left">		
		<form id="uploadbanner" action="/oneUp/instructors/luaLibUploadView" enctype="multipart/form-data" method="POST" >
			{% csrf_token %}   			
   			<table class="bg">
   			   <tr>
   			   		{% if libEdit %}
   			   			<th>Edit {{libName}}</th>
   			   		{% else %}
 		                 <th>Upload New Library</th>
 		            {% endif %}      			
   			   </tr>
   			   <tr>
   			      <td><input id="fileupload" name="libfile" type="file" /></td>
   			   </tr>
   			    <tr>
                  <td>Library Name:</td>
               </tr>
               <tr>
                  <td>
                  	<input style="border: solid 1px rgba(128, 128, 128, 0.5)" type="text" name="libraryName" id="libraryName" {% if libEdit %}value="{{libName}}"{%endif%}
                  		onchange="checkUnique()">
                  	<div id="uniqueNameWarning" style="display:none" color="red">Libraries are required to have unique names!  That one is already taken!</div>
                  </td>
               </tr>  
               <tr>
                  <td>Library Description:</td>
               </tr>
               <tr>
                  <td>
                  	  {% if libEdit %}	
                      	<input style="border: solid 1px rgba(128, 128, 128, 0.5)" type="text" name="libDescription" id="preview" value="{{libDescription}}" >
                      {% else %}
                      	<input style="border: solid 1px rgba(128, 128, 128, 0.5)" type="text" name="libDescription" id="preview">
					  {% endif %}	                      
                  </td>
				</tr> 
				<tr>
					<td>
					   	{% include "Instructors/luaLibraryDependencies.html" %}
					</td>
				</tr>                      
   			</table>
   			
   			<input type="hidden" name="libID" id="libID" value="{{libID}}"> 
   			<input type="submit" value="Upload" id="Upload" align="center"/>
        	 <a href="/oneUp/instructors/instructorCourseHome"><input type="button" class="special" value="Back"></a> 
   		   			
   			</form>
		<br/>
		<br />
   			
       <!-- INSERTED DYNAMIC TABLE --> 
            <table class="bg" id="libsTable">
            	<tr>
            		<th>Dependencies</th><th></th><th></th><th></th><th></th>
            	</tr>            
   			   <tr>
                  <td>Selection</td>
                   <td>Library Name</td> 
                   <td>Library Description</td>  			

            	{% for lib in lib_range %}
            	{% csrf_token %}
            	<tr>
					<td><input type="checkbox" name="depend[]" value={{libIDs}}></td>

					<td> {{lib.name}}</td>
					<td> {{lib.description}}</td>
					
					{% if lib.myLib %}
				 		<td>
							<form 
								{% if lib.hasDependents %} action="/oneUp/instructors/luaLibraryDeletionConfirmation"
								{% else %} action="/oneUp/instructors/luaLibDelete" {% endif %}
							method="POST">
						    	{% csrf_token %}
						    	<input type="hidden" name="libID" value="{{lib.ID}}">
						    	<input type="submit" name="submit" value="Delete" class="button" {% if not lib.hasDependents %} onclick="return confirm('Are you sure you want to delete?')" {% endif %}>
							</form>
						</td>
						<td>
							<form action="/oneUp/instructors/luaLibEdit" method="POST">
						    	{% csrf_token %}
						    	<input type="hidden" name="libID" value="{{lib.ID}}">
						    	<input type="submit" name="submit" value="Edit" class="button" onclick="return confirm('Are you sure you want to Edit?')">
							</form>
						</td>
					{% endif %}
		 		{% endfor %}	 		
        	</table>
		
        	 <!--  <input type="submit" name="submit" value="Save" class="button">  --> 	 
            <br><br> 
        <!-- END DYNAMIC TABLE -->
        
		
		</div>
        </div>
        </div>
      	</div>
      
        <script>
      		function checkUnique() {
      			curName = document.getElementById("libraryName").value;
      			libId = document.getElementById("libID").value;
      			same = false;
            	{% for lib in lib_range %}
	      			if ((curName == "{{lib.name}}") && (libID != "{{lib.ID}}")) {
						same = true;
	      			}
      			{% endfor %}
      			warning = document.getElementById("uniqueNameWarning");
      			upload = document.getElementById("Upload");
      			if (same) {
      				warning.style.display = "block";
      				upload.disabled = true;
      			} else {
      				warning.style.display = "none";
      				upload.disabled = false;
      			}

      		}
      	</script>
      	
	<!-- Footer -->

     {% include 'footer.html' %}

	</div>`

</body>
</html>