<header>
<style>
	i.icon-yellow:hover {
		color: yellow;
	}
</style>

<!-- Used for the notifications -->
{% load staticfiles %}       
{% load notification_tags %}
{% include_notify_js_variables %}
<script src="{% static "notify/notifyX.js" %}"></script>
<script>
	var updateSuccess = function (response) {
	    var notification_box = $('#nMenu1');
		var notification_box2 = $('#nMenu2');
	    var notifications = response.notifications;
	    $.each(notifications, function (i, notification) {
	        notification_box.prepend(notification.html);
			notification_box2.prepend(notification.html);
	    });
	    
	    //IF table on page then update
	};


	function countNotifications(){
		numItems = Math.trunc($('.navNotifications').length/2.0);
		$('.tooltipped').tooltip({delay: 50});
		if(numItems == 0){
			numItems = null;

			document.getElementById("notification-count1").setAttribute('data-tooltip', "No Notifications");
			document.getElementById('notification-count1').children[0].innerHTML = 'notifications';

			x = document.getElementById("nMenu1").children;
			x = x[0];
			y = document.createElement('li');
			y.innerHTML = "<a class='waves-effect grey-text text-darken-2' href='#!'>No new notifications yet</a>"
			x.parentNode.replaceChild(y, x);

			document.getElementById("notification-count2").style.display = "none";

			x = document.getElementById("nMenu2").children;
			x = x[0];
			y = document.createElement('li');
			y.innerHTML = "<a class='waves-effect grey-text text-darken-2' href='#!'>No new notifications yet</a>"
			x.parentNode.replaceChild(y, x);
			
			document.getElementById("clearAll").style.display = "none";

		} else {
			document.getElementById("notification-count1").setAttribute('data-tooltip', numItems + " New");
			document.getElementById('notification-count1').children[0].innerHTML = 'notifications_active';

			document.getElementById("notification-count2").style.display = "visible";
			document.getElementById("notification-count2").textContent= numItems;

			document.getElementById("clearAll").style.display = "inline";
		}
		
	}
	
	$(document).ready(function() {
		countNotifications();
		setInterval(function(){
			countNotifications();
		}, 5000);
		$('.tooltipped').tooltip({delay: 50});
	});	
	
		$(document).on('click', '#clearAll', function() {
			console.log("Clear all clicked")
	        $(".delete-box").click();
			countNotifications();
			document.getElementById("clearAll").style.display = "none";

	    });
</script>
		<ul id="account" class="dropdown-content">
			{% if ccparams.gamificationUsed and ccparams.avatarUsed %}
			<li><p class="center-align"><img class="circle" width="100" height="100" src="{{avatar}}"></p></li>
			{% endif %}
			<li><p class="center-align">Welcome, {{username}}</p></li>            
			<li><p class="center-align">Course: {{course_Name}}</p></li>
			<li class="divider"></li>
			<li><a href="/oneUp/administrators/courses">Change Course</a></li>
			<li><a href="/oneUp/students/Logout">Logout</a></li>
		</ul>
		<ul id="virtualcurrency" class="dropdown-content">                               
			<li><a href="/oneUp/students/VirtualCurrencyShop">Course Shop</a></li>
			<li><a href="/oneUp/students/EarnedVCTransactions">Your Earning Transactions</a></li>
			<li><a href="/oneUp/students/Transactions">Your Spending Transactions</a></li>
		</ul>
		<nav>
			<div class="nav-wrapper">
			<a href="#" class="brand-logo" ><i class="large material-icons icon-yellow">lightbulb_outline</i>OneUp</a>
			<a href="#" data-activates="slide-out" class="button-collapse"><i class="material-icons">menu</i></a>
			<ul class="right hide-on-med-and-down">
				<li>
					<a class="dropdown-button" href="#!" data-constrainwidth="false" data-beloworigin="true" data-activates="courseinfo">Course Infomation</a>
					<ul id="courseinfo" class="dropdown-content">
						<li><a class="waves-effect" href="/oneUp/students/StudentHome">Student's Home</a></li>
						<li><a class="waves-effect" href="/oneUp/students/StudentCourseHome">Course Home</a></li>						
						<li><a class="waves-effect" href="/oneUp/students/CourseInformation">Course Information</a></li>
						<li><a class="waves-effect" href="/oneUp/students/Announcements">Announcements</a></li>	
						<!-- GGM added leaderboard to navigation bar -->
						{%if ccparams.gamificationUsed and ccparams.leaderboardUsed and studentLeaderboardToggle %}
						<li><a class="waves-effect" href="/oneUp/students/Leaderboard">Leaderboard</a></li>
						{% endif %}						
						{%if ccparams.gamificationUsed and ccparams.badgesUsed %}
						<li><a class="waves-effect" href="/oneUp/badges/CourseBadges">Course Badges</a></li>
						{% endif %}
						{%if ccparams.gamificationUsed and ccparams.virtualCurrencyUsed %}
						<li><a class="waves-effect" href="/oneUp/students/VirtualCurrencyRules">Currency Rules</a></li>
						{% endif %}
					</ul>
				</li>
				<li><a class="waves-effect" href="/oneUp/students/ChallengesWarmUpList">Warm Up Challenges</a></li>
				<li><a class="waves-effect" href="/oneUp/students/ChallengesList">Serious Challenges</a></li>
				<li><a class="waves-effect" href="/oneUp/students/ActivityList">Activities</a></li>
				<li><a class="waves-effect" href="/oneUp/students/CoursePerformance">Course Performance</a></li>
				{%if ccparams.gamificationUsed %}
				<li><a class="waves-effect" href="/oneUp/students/achievements">Achievements</a></li>
				{% if  ccparams.avatarUsed or  ccparams.virtualCurrencyUsed or ccparams.studCanChangeclassAverageVis or ccparams.studCanChangeClassSkillsVis or ccparams.studCanChangeLeaderboardVis or ccparams.studCanChangeBadgeVis %}
				<li>
					<a class="dropdown-button" href="#!" data-constrainwidth="false" data-beloworigin="true" data-activates="coursetools">Tools</a>
					<ul id="coursetools" class="dropdown-content">
						{% if ccparams.avatarUsed %}
						<li><a class="waves-effect" href="/oneUp/students/avatar">Avatar Selection</a></li>
						{% endif %}
						{% if ccparams.virtualCurrencyUsed %}
						<li><a class="waves-effect" href="/oneUp/students/VirtualCurrencyShop">Course Shop</a></li>
						<li><a class="waves-effect" href="/oneUp/students/EarnedVCTransactions">Your Earning Transactions</a></li>
						<li><a class="waves-effect" href="/oneUp/students/Transactions">Your Spending Transactions</a></li>
						{% endif %}
						{% if ccparams.studCanChangeclassAverageVis or ccparams.studCanChangeClassSkillsVis or ccparams.studCanChangeLeaderboardVis or ccparams.studCanChangeBadgeVis %}
						<li><a class="waves-effect" href="/oneUp/students/Preferences">Preferences</a></li>
						{% endif %}
					</ul>
				</li>
				{% endif %}
				{% endif %}
				<li>
					<a class="waves-effect" href="/oneUp/students/StudentQA">Help</a>
				</li>
				<li>
					<a id='notification-count1' class='dropdown-button tooltipped' href='#!' data-constrainwidth ='false' data-beloworigin='true' data-activates='notifications' data-position="left" data-delay="50">
						<i class='material-icons'>notifications</i> <!-- This needs to be linked to an actual notification page -->
					</a>
					<ul id="notifications" class="dropdown-content">
						<div id="nMenu1" class="notification-box-list">
						{% user_notifications for box %}
						</div>
						<li id="clearAll"><a class="waves-effect" href="#!"><i class="material-icons">clear_all</i>Clear All</a></li>
					</ul>
				</li>
				{% if logged_in %}            
				<li><a class="dropdown-button" href="#!" data-constrainwidth="false" data-beloworigin="true" data-activates="account"><i class="material-icons">more_vert</i></a></li>
				{% endif %}
			</ul>
			<ul class="side-nav" id="slide-out">
				{% if logged_in %}
				<li>
					<div class="user-view">
						<div class="background">
						  <img src="/static/images/pic01.jpg">
						</div>
						{% if ccparams.gamificationUsed and ccparams.avatarUsed %}
						<a href="#!user"><img class="circle" src="{{avatar}}"></a>
						{% endif %}
						<a href="#!name"><span class="white-text name">Welcome, {{username}}</span></a>
						<a href="#!email"><span class="white-text email">Course: {{course_Name}}</span></a>
					  </div>
				</li>   
				{% endif %}             
				<li class="no-padding">
					<ul class="collapsible collapsible-accordion">
						<li>
							<a class="collapsible-header"><i class="material-icons">info</i>Course Infomation</a>
							<div class="collapsible-body">
								<ul>
									<li><a class="waves-effect" href="/oneUp/students/StudentHome">Student's Home</a></li>
									<li><a class="waves-effect" href="/oneUp/students/StudentCourseHome">Course Home</a></li>							
									<li><a class="waves-effect" href="/oneUp/students/CourseInformation">Course Information</a></li>
									<li><a class="waves-effect" href="/oneUp/students/Announcements">Announcements</a></li>	
									{%if ccparams.gamificationUsed and ccparams.leaderboardUsed and studentLeaderboardToggle %}
									<li><a class="waves-effect" href="/oneUp/students/Leaderboard">Leaderboard</a></li>
									{% endif %}						
									{%if ccparams.gamificationUsed and ccparams.badgesUsed %}
									<li><a class="waves-effect" href="/oneUp/badges/CourseBadges">Course Badges</a></li>
									{% endif %}
									{%if ccparams.gamificationUsed and ccparams.virtualCurrencyUsed %}
									<li><a class="waves-effect" href="/oneUp/students/VirtualCurrencyRules">Currency Rules</a></li>
									{% endif %}
								</ul>
							</div>
						</li>
						<li><a class="collapsible-header waves-effect" href="/oneUp/students/ChallengesWarmUpList"><i class="material-icons">fitness_center</i>Warm Up Challenges</a></li>
						<li><a class="collapsible-header waves-effect" href="/oneUp/students/ChallengesList"><i class="material-icons">star</i>Serious Challenges</a></li>
						<li><a class="collapsible-header waves-effect" href="/oneUp/students/ActivityList"><i class="material-icons">toys</i>Activities</a></li>
						<li><a class="collapsible-header waves-effect" href="/oneUp/students/CoursePerformance"><i class="material-icons">timeline</i>Course Performance</a></li>
						{%if ccparams.gamificationUsed %}
						<li><a class="collapsible-header waves-effect" href="/oneUp/students/achievements"><i class="material-icons">flare</i>Achievements</a></li>
						{% if  ccparams.avatarUsed or  ccparams.virtualCurrencyUsed or ccparams.studCanChangeclassAverageVis or ccparams.studCanChangeClassSkillsVis or ccparams.studCanChangeLeaderboardVis or ccparams.studCanChangeBadgeVis %}
						<li>
							<a class="collapsible-header"><i class="material-icons">build</i>Tools</a>
							<div class="collapsible-body">
								<ul>
									{% if ccparams.avatarUsed %}
									<li><a class="waves-effect" href="/oneUp/students/avatar">Avatar Selection</a></li>
									{% endif %}
									{% if ccparams.virtualCurrencyUsed %}
									<li>
										<li><a class="dropdown-button" id="clearAll" href="#!" data-constrainwidth="false" data-alignment="right" data-beloworigin="true" data-activates="virtualcurrency">Virtual Currency<i class="material-icons right">more_vert</i></a></li>                                    
									</li>
									{% endif %}
									{% if ccparams.studCanChangeclassAverageVis or ccparams.studCanChangeClassSkillsVis or ccparams.studCanChangeLeaderboardVis or ccparams.studCanChangeBadgeVis %}
									<li><a class="waves-effect" href="/oneUp/students/Preferences">Preferences</a></li>
									{% endif %}
									
								</ul>
							</div>
						</li>
						{% endif %}
						<li>
							<a class="collapsible-header waves-effect" href="/oneUp/students/StudentQA"><i class="material-icons">help</i>Help</a>
						</li>
						{% endif %}
						<li>
							<a class='collapsible-header'><i class='material-icons'>notifications</i>Notifications  <div class='right'><span id='notification-count2' class="new badge red"></span></div></a>
							<div class='collapsible-body'>
								<ul>
									<div id="nMenu2" class="notification-box-list">
									{% user_notifications for box %}
									</div>			
									<li id="clearAll"><a class="waves-effect" href="#!"><i class="material-icons">clear_all</i>Clear All</a></li>					
								</ul>
							</div>
						</li>
					</ul>
				</li>
				{% if logged_in %}                        
				<li class="divider"></li>
				<li><a class="waves-effect" href="/oneUp/administrators/courses">Change Course</a></li>
				<li><a class="waves-effect" href="/oneUp/students/Logout">Logout</a></li>
				{% endif %}
			</ul>
			</div>
		</nav>
	</header>
