<header>
<style>
    i.icon-yellow:hover {
        color: yellow;
    }
    .dropdown-nested {
			overflow-y: visible;
		}
		.dropdown-content .dropdown-content {
			margin-left: 100%;
		}
    .notification-count-parent:hover,
    .clearAll:hover
     {
        background-color: white;
    }
    .notification-badge {
        position:relative;
        padding:5px 9px;
        background-color: #fff;
        color: #941e1e;
        bottom: 15px;
        left: 15px;
        border-radius: 50%;
    }
    .notification-badge .hide {
        display: none;
    }
    .notification-icon {
        position: relative;
    }
    .notification-icon-notify {
        position: absolute;
    }
    .nav-dropdown-link, .nav-dropdown-link:hover {
        background-color: transparent !important;
    }
</style>
{% load staticfiles %}       
{% load notification_tags %}
{% include_notify_js_variables %}
<script src="{% static "notify/notifyX.js" %}"></script>
<script>
        var updateSuccess = function (response) {
            if(response['retrieved'] > 0){
                var notification_box_desktop = $('#notifications-desktop');
                var notification_box_mobile = $('#notifications-mobile');
                
                var course_id = '{{course_id}}';
                var notifications = response.notifications;
                notifications.forEach(notification => {
                    let notification_data = JSON.parse(notification.data);
                    // console.log(notification_data);
                    if(notification_data['course'] == course_id){
                        notification_box_desktop.prepend(notification.html);
                        notification_box_mobile.prepend(notification.html);

                        // $(`#course-name-${notification.id}`).html(notification_data['name'])
                        updateNotificationsCourseName(notification.id)
                    }
                });

                removeDuplicates();
                countNotifications();
            }
        };
        markAllNotificationSelector = '.mark-all';
        var markAllSuccess = function(response) {
            var mark_class = 'read';
            var remove_class = 'unread';
            if(response['action'] == 'unread'){
                mark_class = 'unread';
                remove_class = 'read';
            }
            //console.table(response);
            $('.notification').removeClass(remove_class).addClass(mark_class);
            countNotifications();
        }
        
        var deleteSuccess = function(response, $notification){
            // If notification deleted from desktop remove from mobile side as well and vice versa
            var notification_box_desktop = $('#notifications-desktop');
            var notification_box_mobile = $('#notifications-mobile');
            var notification_div_page = $('#noti-div');
            
            var notification_id = $notification.attr("data-id");

            function removeAll(notification_box, id){
                notification_box.children("li[data-nf-id='"+id+"']").each(function(index){
                    $(this).remove();
                });
            }
            function removeNoti(notification_div_page, id){
                
				$('#'+id).remove();

            }


            removeAll(notification_box_desktop, notification_id);
            removeAll(notification_box_mobile, notification_id);

            var is_stud_notification_page = '{{is_stud_notification_page}}';
			var is_display_active_noti = '{{is_display_active_noti}}';
			if (is_stud_notification_page == '1' && is_display_active_noti == '1'){
				removeNoti(notification_div_page, notification_id);
				let notifications = $('#noti-div').children();
				if(notifications.length == 0){
					$('#noti-div').append('<tr><td class="center-align" colspan="3"><i>No Notifications</i></td></tr>');
				}
            }
            
            countNotifications();
        }
        var removeDuplicates = function(){
            // Fixes weird bug with notifications. Once notification is created it can create more than one at a time.
            // Ex. student buys 3 items from shop it sends 6 notifications
            var notification_box_desktop = $('#notifications-desktop');
            var notification_box_mobile = $('#notifications-mobile');
            var notification_div_page = $('#noti-div');

            function removeDupes(notification_box){
                var seen = {};
                notification_box.children().each(function(index){
                    if(seen[$(this).attr("data-nf-id")] == true){
                        $(this).remove();
                    }
                    else{
                        seen[$(this).attr("data-nf-id")] = true;
                    }
                });
            }

            removeDupes(notification_box_desktop);
            removeDupes(notification_box_mobile);

            if(notification_div_page)
				removeDupes(notification_div_page);
        }
        function updateNotificationsCourseName(id){
			try{
				var json = JSON.parse($(`#course-name-${id}`).html())
			} catch {
				return;
			}
			// console.log(json)
			$(`#course-name-${id}`).html(json['name'])
        }
        function limitNotifications(limit, size){
            if(size == 0) return;
			if(size <= limit) return;
            // Limit notifications on both mobile and desktop sides
            var notification_box_desktop = $('#notifications-desktop');
            var notification_box_mobile = $('#notifications-mobile');

            function limitNotificationsInBox(notification_box){
                var notifications = notification_box.children();
                for(var i = 0; i <= Math.min(limit, size-1); i++){
                    notifications[i].classList.remove("hide");
                }

                var stop_index = size - limit;
                for(var i = size-1; i > ((size-1) - stop_index); i--){
                    notifications[i].classList.add("hide");
                }
                
            }

            limitNotificationsInBox(notification_box_desktop);
            limitNotificationsInBox(notification_box_mobile);
        }
        function countNotifications(){

            var all_notifications_count = $('nav .notification-box-list').children().length / 2;

            // Remove magic "no new notifications yet" element when there are no notifications and add a customized one
            let notifications = $('nav .notification-box-list').children();
            if(notifications.length == 0){
                $('nav .notification-box-list').append('<li><a class="no-notifications waves-effect nav-dropdown-link" href="/oneUp/students/NotificationPage">No notifications (View all)</a></li>');
            }
            var empty = all_notifications_count == 1;
            var removed_empty = false;
            for(var i = notifications.length-1; i >= 0; i--){
                // This is our custom one just set notification count to 0
                if(notifications[i].innerHTML == '<a class="no-notifications waves-effect nav-dropdown-link" href="/oneUp/students/NotificationPage">No notifications (View all)</a>'){
                    if(all_notifications_count == 1 && empty){
                        all_notifications_count = 0;
                        break;
                    } else {
                        notifications[i].remove();
                        if(removed_empty == false)
                            all_notifications_count--;
                        continue;
                    }
                }
                // This is the magic one. Remove it and add our custom one and set notification count to 0
                if(notifications[i].innerHTML == 'No notifications yet.'){
                    if(all_notifications_count == 1 && empty) {
                        $('nav .notification-box-list').empty();
                        all_notifications_count = 0;
                        // Add "No notifications" for mobile and desktop
                        $('nav .notification-box-list').append('<li><a class="no-notifications waves-effect nav-dropdown-link" href="/oneUp/students/NotificationPage">No notifications (View all)</a></li>');
                        break;
                    } else {
                        notifications[i].remove();
                        if(removed_empty == false)
                            all_notifications_count--;
                        continue;
                    }
                }
                updateNotificationsCourseName($(notifications[i]).attr('data-nf-id'));
            }
            
            // Limit the number of notifications 
            limitNotifications(6, all_notifications_count);
            let unread_count = $('nav .unread').length / 2;
            //console.trace(unread_count);

            // Desktop/Tablet element
            let icon_element = $("#notification-count-desktop").children(":first");
            // Mobile element
            let badge_element = document.getElementById("notification-count-mobile");

            // Get "Notifications #" count element in the dropdown on the desktop screen
            var notification_count_element = document.getElementsByClassName('notification-count')[0];
            
            // Display Desktop "Notifications #" count element if notifications count is > 0
            if(all_notifications_count > 0)
                notification_count_element.parentNode.parentNode.style.display = "inline";
            else
                notification_count_element.parentNode.parentNode.style.display = "none";

            notification_count_element.innerHTML = all_notifications_count;
            
            // Display "Clear All" elements (mobile and desktop) if notifications count is > 0
            clearAll_elements = document.getElementsByClassName('clearAll');
            for(var i = 0; i < clearAll_elements.length; i++){
                let element = clearAll_elements[i];
                if(all_notifications_count > 0)
                    element.parentNode.style.display = "inline";
                else 
                    element.parentNode.style.display = "none";
            }

            // Show/hide unread counts for notification bubble and mobile badge
            if(unread_count == 0){      

                // Desktop bubble
                icon_element.removeClass("notification-icon-notify");
                icon_element.addClass("notification-icon");
                $(".notification-badge").addClass("hide");

                // Hide badge for mobile view
                badge_element.style.display = "none";
    
            } else {
                
                // Desktop bubble
                icon_element.removeClass("notification-icon");
                icon_element.addClass("notification-icon-notify");
                $(".notification-badge").removeClass("hide").html(unread_count);

                // Show badge for mobile view and set count 
                badge_element.style.display = "block";
                badge_element.textContent= unread_count;
                
            }
            
        }
        
        $(document).ready(function() {
            countNotifications();
            $('.dropdown-button-badges').dropdown({
                hover: true, // Activate on hover
                gutter: $("#gamefeats").width() * 2, // Spacing from edge
                alignment: 'right' // Displays dropdown with edge aligned to the left of button
                }
            );
            $('.dropdown-button-vc').dropdown({
                hover: true, // Activate on hover,
                constrainWidth: false,
                gutter: $("#gamefeats").width() * 2, // Spacing from edge
                alignment: 'right' // Displays dropdown with edge aligned to the left of button
                }
            );
            $('.dropdown-button-visualization').dropdown({
                hover: true, // Activate on hover
                gutter: $("#coursereports").width() * 2, // Spacing from edge
                alignment: 'right' // Displays dropdown with edge aligned to the left of button
                }
            );
            $('.dropdown-button-logs').dropdown({
                hover: true, // Activate on hover
                gutter: $("#coursereports").width() * 2, // Spacing from edge
                alignment: 'right' // Displays dropdown with edge aligned to the left of button
                }
            );
            
        });	
        
        $(document).on('click', '.clearAll', function() {
            $(".delete-box").click();
            countNotifications();
        });
    </script>
    <form action="/oneUp/instructors/resetTestStudent" method="POST">
        {% csrf_token %}
        <input type=hidden  name="courseID" value={{courseId}}>
        <div id="reset_test_student" class="modal">
            <div class="modal-content">
                <h5>Reset Test Student's Data? </h5>
                <p>This action will delete any taken challenge, activity, earned badge, and virtual currency. This cannot be undone</p>
            </div>
            <div class="modal-footer">
                <a href="#!" class="modal-action modal-close waves-effect waves-light btn-flat" style="color: #00bcd4">Cancel</a>
                <button class="modal-action modal-close waves-effect waves-light btn-flat" type="submit" name="submit" value="Delete">Reset</button>                                        
            </div>
        </div>
    </form>

    <ul id="account" class="dropdown-content">
        <li class="nav-dropdown-link"><p style="padding-left: 16px; padding-right: 8px">Welcome, {{username}}</p></li>            
        <li class="nav-dropdown-link"><p style="padding-left: 16px; padding-right: 8px">Course: {{course_Name}}</p></li>
        <li class="divider"></li>
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/administrators/courses">Change Course</a></li>
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/students/Logout">Logout</a></li>
    </ul>
    <ul id="visualization" class="dropdown-content">
        {% if ccparams.seriousChallengesUsed %}
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/classAchievementsViz?serious">Serious Challenges</a></li>
        {% endif %}
        {% if ccparams.warmupsUsed %}
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/classAchievementsViz?warmUp">Warm-Up Challenges</a></li>
        {% endif %}
        {% if ccparams.skillsUsed %}
        {% if ccparams.warmupsUsed or ccparams.seriousChallengesUsed %}
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/classAchievementsViz?skills">Skills</a></li>  
        {% endif %}
        {% endif %}
    </ul>
    <ul id="visualization-mobile" class="dropdown-content">
        {% if ccparams.seriousChallengesUsed %}
        <li><a class="waves-effect" href="/oneUp/instructors/classAchievementsViz?serious">Serious Challenges</a></li>
        {% endif %}
        {% if ccparams.warmupsUsed %}
        <li><a class="waves-effect" href="/oneUp/instructors/classAchievementsViz?warmUp">Warm-Up Challenges</a></li>
        {% endif %}
        {% if ccparams.skillsUsed %}
        {% if ccparams.warmupsUsed or ccparams.seriousChallengesUsed %}
        <li><a class="waves-effect" href="/oneUp/instructors/classAchievementsViz?skills">Skills</a></li>  
        {% endif %}
        {% endif %}
    </ul>
    <ul id="logs" class="dropdown-content">
        {% if ccparams.badgesUsed%}
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/whoAddedBadgeAndVC?type=badge">Badge Log</a></li>
        {% endif %}
        {% if ccparams.virtualCurrencyUsed%}
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/whoAddedBadgeAndVC?type=vc">VC Log</a></li>
        {% endif %}
    </ul>
    <ul id="import-export" class="dropdown-content">
        {% if ccparams.warmupsUsed or ccparams.seriousChallengesUsed %}
        <li><a class="waves-effect" href="/oneUp/instructors/exportChallenges">Export Challenges</a></li>
        <li><a class="waves-effect" href="/oneUp/instructors/uploadChallenges">Import Challenges</a></li>
        {% endif %}
        {% if ccparams.gradebookUsed %}
        <li><a class="waves-effect" href="/oneUp/instructors/exportGradebook">Export GradeBook</a></li>
        {% endif %}
        <li><a class="waves-effect" href="/oneUp/instructors/exportCourse">Export Course</a></li>
        <li><a class="waves-effect" href="/oneUp/instructors/importCourse">Import Course</a></li>
    </ul>
    <ul id="virtualcurrency" class="dropdown-content"> 
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/badges/VirtualCurrencySpendRuleList">Spending Rules</a></li>
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/badges/VirtualCurrencyEarnRuleList?isRuleCustom=false">Automatic Earning Rules</a></li>
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/badges/PeriodicVirtualCurrencyEarnRuleList">Time Period Earning Rules</a></li>
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/badges/VirtualCurrencyEarnRuleList?isRuleCustom=true">Manual Earning Rules</a></li>
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/badges/AddVirtualCurrency">Add Virtual Currency to Students</a></li>
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/badges/VirtualCurrencyTransactions">Student Transactions</a></li>  
    </ul>
    <ul id="virtualcurrency-mobile" class="dropdown-content"> 
        <li><a class="waves-effect" href="/oneUp/badges/VirtualCurrencySpendRuleList">Spending Rules</a></li>
        <li><a class="waves-effect" href="/oneUp/badges/VirtualCurrencyEarnRuleList?isRuleCustom=false">Automatic Earning Rules</a></li>
        <li><a class="waves-effect" href="/oneUp/badges/PeriodicVirtualCurrencyEarnRuleList">Time Period Earning Rules</a></li>
        <li><a class="waves-effect" href="/oneUp/badges/VirtualCurrencyEarnRuleList?isRuleCustom=true">Manual Earning Rules</a></li>
        <li><a class="waves-effect" href="/oneUp/badges/AddVirtualCurrency">Add Virtual Currency To Students</a></li>
        <li><a class="waves-effect" href="/oneUp/badges/VirtualCurrencyTransactions">Student Transactions</a></li>  
    </ul>
    <ul id="badges" class="dropdown-content">
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/badges/Badges">Automatic & Manual Badges</a></li>
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/badges/PeriodicBadges">Time-Period Based Badges</a></li>
        <li><a class="waves-effect nav-dropdown-link" href="/oneUp/badges/AddBadgeManually">Add Badges to Students</a></li>
    </ul>
    <ul id="badges-mobile" class="dropdown-content">
        <li><a class="waves-effect" href="/oneUp/badges/Badges">Automatic & Manual Badges</a></li>
        <li><a class="waves-effect" href="/oneUp/badges/PeriodicBadges">Time-Period Based Badges</a></li>
        <li><a class="waves-effect" href="/oneUp/badges/AddBadgeManually">Add Badges to Students</a></li>
    </ul>
    <nav>
        <div class="nav-wrapper">
        <a href="#" class="brand-logo"><i class="large material-icons icon-yellow">lightbulb_outline</i>OneUp</a>
        <a href="#" data-activates="slide-out" class="button-collapse"><i class="material-icons">menu</i></a>
        <ul class="right hide-on-med-and-down" style="height: 100%;">
            <li>
                <a class="dropdown-button" href="#!" data-constrainwidth="false" data-beloworigin="true" data-activates="coursetools">Course Tools</a>
                <ul id="coursetools" class="dropdown-content">
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/instructorHome">Instructor's Home</a></li>
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/instructorCourseHome">Course Home</a></li>
                    {%if ccparams.announcementsUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/announcementList">Announcements</a></li>
                    {% endif %}
                    {%if ccparams.streaksUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/studentAttendance">Set Student Attendance</a></li>
                    {% endif %}
                    <!-- {% if ccparams.chatUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/chat/api">Chat</a></li>
                    {% endif %} -->
                    {% if ccparams.warmupsUsed or ccparams.seriousChallengesUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/exportChallenges">Export Challenges</a></li>
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/uploadChallenges">Import Challenges</a></li>
                    {% endif %}
                    {% if ccparams.gradebookUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/exportGradebook">Export GradeBook</a></li>  
                    {% endif %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/exportCourse">Export Course</a></li>
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/importCourse">Import Course</a></li>  
                  	<li><a class="modal-trigger nav-dropdown-link" href="#reset_test_student">Reset Test Student</a></li>                   	
                </ul>
            </li>
            <li>
                <a class="dropdown-button" href="#!" data-constrainwidth="false" data-beloworigin="true" data-activates="courseinfo">Course Information</a>
                <ul id="courseinfo" class="dropdown-content">
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/courseInformation">Course Description</a></li>
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/createStudentListView">Students</a></li>
                    {% if ccparams.warmupsUsed or ccparams.seriousChallengesUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/topicsList">Course Topics</a></li>
                    {%if ccparams.skillsUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/skillsList">Targeted Skills</a></li>
                    {% endif %}
                   
                    {% endif %}
                    {% if ccparams.activitiesUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/activityCats">Activity Categories</a></li>
                    {% endif %}
                    {% if ccparams.gamificationUsed and ccparams.streaksUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/attendanceStreaks">Attendance Streaks</a></li>
                    {% endif %}
                    {% if ccparams.gamificationUsed and ccparams.leaderboardUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/instructorLeaderboard">Course Leaderboard</a></li>
                    {% endif %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/courseConfiguration">Course Configuration</a></li>                    
                </ul>
            </li>
            <li>
                <a class="dropdown-button" href="#!" data-constrainwidth="false" data-beloworigin="true" data-activates="coursecontent">Course Content</a>
                <ul id="coursecontent" class="dropdown-content">
                	{% if ccparams.activitiesUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/activitiesList">Activities</a></li>
                    {% endif %}
                    {% if ccparams.seriousChallengesUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/challengesList">Serious Challenges</a></li>
                    {% endif %}
                    {% if ccparams.warmupsUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/warmUpChallengeList">Warm-Up Challenges</a></li>		
                    {% endif %}				
                    {% if ccparams.warmupsUsed or ccparams.seriousChallengesUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/challengeQuestionsList?problems">Problems</a></li>
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/luaLibUploadView">Libraries for Dynamic Problems</a></li>
                    {% endif %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/imageList">Images</a></li>
                </ul>
            </li>
            <li>
                <a class="dropdown-button" href="#!" data-constrainwidth="false" data-beloworigin="true" data-activates="coursereports">Course Reports</a>
                <ul id="coursereports" class="dropdown-content dropdown-nested">
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/studentAchievements">Students Scores</a></li>
                    {% if ccparams.gradebookUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/classAchievements">Class Scores</a></li>
                    {% endif %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/studentSummary">Student Summary</a></li>
                    {% if ccparams.streaksUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/studentAttendanceReport">Student Attendance</a></li>
                    {% endif %}
                    {% if ccparams.gamificationUsed %}
                    {% if ccparams.badgesUsed or ccparams.virtualCurrencyUsed  %}
                    <li><a class="dropdown-button-logs nav-dropdown-link" style="background-color: white !important; cursor: default !important;" href="#!" data-activates="logs">Logs</a></li>
                    {% endif %}
                    {% endif %}
                    
                    {% if ccparams.warmupsUsed or ccparams.seriousChallengesUsed or ccparams.skillsUsed  %}
                    <li><a class="dropdown-button-visualization nav-dropdown-link" style="background-color: white !important; cursor: default !important;" href="#!" data-activates="visualization">Visualization</a></li>
                    {% endif %}
                    {% if ccparams.gamificationUsed and ccparams.classmatesChallenges %}
                    <li><a class="waves-effect nav-dropdown-link"  href="/oneUp/instructors/DuelReport">Duel Report</a></li>
                    <li><a class="waves-effect nav-dropdown-link"  href="/oneUp/instructors/CalloutReport">Callout Report</a></li>
                    {% endif %}
                </ul>
            </li>
            {% if ccparams.gamificationUsed %}
            <li>
                <a class="dropdown-button" href="#!" data-constrainwidth="false" data-beloworigin="true" data-activates="gamefeats">Game Features</a>
                <ul id="gamefeats" class="dropdown-content dropdown-nested">
                    {% if ccparams.badgesUsed %}
                    <li><a class="dropdown-button-badges nav-dropdown-link" style="background-color: white !important; cursor: default !important;" href="#!" data-activates="badges">Badges</a></li>
                    {% endif %}
                    {% if ccparams.virtualCurrencyUsed %}
                    <li><a class="dropdown-button-vc nav-dropdown-link" style="background-color: white !important; cursor: default !important;" href="#!" data-activates="virtualcurrency" >Virtual Currency</a></li>
                    {% endif %}
                    {% if ccparams.leaderboardUsed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/dynamicLeaderboard">Leaderboards</a></li>    
                    {% endif %}               

		            {% if ccparams.contentUnlockingDisplayed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/badges/ProgressiveUnlocking">Content Unlocking</a></li>
		            {% endif %}
		            {% if ccparams.debugSystemVariablesDisplayed %}
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/debugSysVars">Debug System Variables</a></li>
		            {% endif %}
		    
                    <li><a class="waves-effect nav-dropdown-link" href="/oneUp/instructors/preferences">Gamification Configuration</a></li>
                </ul>
            </li>
            {% endif %}
            <li>
                <a class="waves-effect" href="/oneUp/instructors/instructorQA">Help</a>
            </li>
            <li>
                <a id='notification-count-desktop' class='dropdown-button mark-all' data-mark-action='read' href='#!' data-constrainwidth ='false' data-beloworigin='true' data-activates='notifications'>
                    <i class='material-icons notification-icon'>notifications</i> <!-- This needs to be linked to an actual notification page -->
                    <small class="notification-badge hide"></small>
                </a>
                <ul id="notifications" class="dropdown-content" style="max-width: 36vw;">
                    <li><a class="notification-count-parent" href="#!">Notifications <span style="float:right;" class="badge notification-count"></span></a></li>
                    <div id="notifications-desktop" class="notification-box-list">
                    {% user_notifications for box %}
                    </div>
                    <li><a class="clearAll waves-effect" href="#!"><i class="material-icons">clear_all</i>Clear All</a></li>
                </ul>
            </li>
            <li>
                <a id='switchview' class='tooltipped' data-tooltip="Switch to student view"  href="/oneUp/instructors/switchView?teacher=true&courseID={{courseId}}" >
                    <i class='material-icons'>visibility</i> 
                </a>
            </li>
            {% if logged_in %}            
            <li><a class="dropdown-button" href="#!" data-constrainwidth="false" data-beloworigin="true" data-activates="account"><i class="material-icons">more_vert</i></a></li>
            {% endif %}
        </ul>


        <!--MOBILE-->
        <ul class="side-nav" id="slide-out">
            {% if logged_in %}
            <li>
                <div class="user-view">
                    <div class="background">
                      <img src="/static/images/pic01.jpg">
                    </div>
                    <a href="#!user"><img class="circle" src="/static/images/avatars/anonymous.png"></a>
                    <a href="#!name"><span class="white-text name">Welcome, {{username}}</span></a>
                    <a href="#!course"><span class="white-text email">Course: {{course_Name}}</span></a>
                  </div>
            </li>   
            {% endif %}             
            <li class="no-padding">
                <ul class="collapsible collapsible-accordion">
                    <li>
                        <a class="collapsible-header"><i class="material-icons">build</i>Course Tools</a>
                        <div class="collapsible-body">
                            <ul>
                                <li><a class="waves-effect" href="/oneUp/instructors/instructorHome">Instructor's Home</a></li>
                                <li><a class="waves-effect" href="/oneUp/instructors/instructorCourseHome">Course Home</a></li>
                                {% if ccparams.announcementsUsed %}
                                <li><a class="waves-effect" href="/oneUp/instructors/announcementList">Announcements</a></li>
                                {% endif %}
                                <li><a class="waves-effect" href="/oneUp/instructors/studentAttendance">Set Student Attendance</a></li>
                                <!-- {% if ccparams.chatUsed %}
                                <li><a class="waves-effect" href="/oneUp/chat/api">Chat</a></li>
                                {% endif %} -->
                                {% if ccparams.warmupsUsed or ccparams.seriousChallengesUsed or ccparams.gradebookUsed %}
                                <li><a class="dropdown-button" href="#!" data-constrainwidth="false" data-alignment="right" data-beloworigin="true" data-activates="import-export">Import/Export<i class="material-icons right">more_vert</i></a></li>                                    
                                {% endif %}
                                <li><a class="modal-trigger" href="#reset_test_student">Reset Test Student</a></li>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <a class="collapsible-header"><i class="material-icons">info</i>Course Information</a>
                        <div class="collapsible-body">
                            <ul>
                                <li><a class="waves-effect" href="/oneUp/instructors/courseInformation">Course Description</a></li>
                                <li><a class="waves-effect" href="/oneUp/instructors/createStudentListView">Students</a></li>
                                {% if ccparams.warmupsUsed or ccparams.seriousChallengesUsed %}
                                <li><a class="waves-effect" href="/oneUp/instructors/topicsList">Course Topics</a></li>
                                {% if ccparams.skillsUsed %}
                                <li><a class="waves-effect" href="/oneUp/instructors/skillsList">Targeted Skills</a></li>
                                {% endif %}
                                <li><a class="waves-effect" href="/oneUp/instructors/milestonesList">Course Milestones</a></li>
                                {% endif %}
                                {% if ccparams.activitiesUsed %}
                                <li><a class="waves-effect" href="/oneUp/instructors/activityCats">Activity Categories</a></li>
                                {% endif %}
                                {% if ccparams.gamificationUsed and ccparams.streaksUsed %}
                                <li><a class="waves-effect" href="/oneUp/instructors/attendanceStreaks">Attendance Streaks</a></li>
                                {% endif %}
                                {% if ccparams.gamificationUsed and ccparams.leaderboardUsed %}
                                <li><a class="waves-effect" href="/oneUp/instructors/leaderboard">Course Leaderboard</a></li>
                                {% endif %}
                                <li><a class="waves-effect" href="/oneUp/instructors/courseConfiguration">Course Configuration</a></li>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <a class="collapsible-header"><i class="material-icons">library_books</i>Course Content</a>
                        <div class="collapsible-body">
                            <ul>
                                {% if ccparams.activitiesUsed %}
                                <li><a class="waves-effect" href="/oneUp/instructors/activitiesList">Activities</a></li>
                                {% endif %}
                                {% if ccparams.seriousChallengesUsed %}
                                <li><a class="waves-effect" href="/oneUp/instructors/challengesList">Serious Challenges</a></li>
                                {% endif %}
                                {% if ccparams.warmupsUsed %}
                                <li><a class="waves-effect" href="/oneUp/instructors/warmUpChallengeList">Warm-Up Challenges</a></li>
                                {% endif %}				
                                {% if ccparams.warmupsUsed or ccparams.seriousChallengesUsed %}
                                <li><a class="waves-effect" href="/oneUp/instructors/challengeQuestionsList?problems">Problems</a></li>
                                <li><a class="waves-effect" href="/oneUp/instructors/luaLibUploadView">Libraries for Dynamic Problems</a></li>
                                {% endif %}
                                <li><a class="waves-effect" href="/oneUp/instructors/imageList">Images</a></li>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <a class="collapsible-header"><i class="material-icons">assessment</i>Course Reports</a>
                        <div class="collapsible-body">
                            <ul>
                                <li><a class="waves-effect" href="/oneUp/instructors/studentAchievements">Students Scores</a></li>
                                {% if ccparams.gradebookUsed %}
                                <li><a class="waves-effect" href="/oneUp/instructors/classAchievements">Class Scores</a></li>
                                {% endif %}
                                <li><a class="waves-effect" href="/oneUp/instructors/studentSummary">Students Summary</a></li>                                                              
                                <li><a class="waves-effect" href="/oneUp/instructors/studentAttendance">Student Attendance</a></li>
                                {% if ccparams.gamificationUsed %}
                                {% if ccparams.badgesUsed%}
                                <li><a class="waves-effect" href="/oneUp/instructors/whoAddedBadgeAndVC?type=badge">Badge Log</a></li>
                                {% endif %}
                                {% if ccparams.virtualCurrencyUsed%}
                                <li><a class="waves-effect" href="/oneUp/instructors/whoAddedBadgeAndVC?type=vc">VC Log</a></li>
                                {% endif %}
                                {% endif %}
                                {% if ccparams.warmupsUsed or ccparams.seriousChallengesUsed or ccparams.skillsUsed  %}
                                <li><a class="dropdown-button" href="#!" data-constrainwidth="false" data-alignment="right" data-beloworigin="true" data-activates="visualization-mobile">Visualization<i class="material-icons right">more_vert</i></a></li>
                                {% endif %}
                                {% if ccparams.gamificationUsed and ccparams.classmatesChallenges %}
                                <li><a class="waves-effect" href="/oneUp/instructors/DuelReport">Duel Report</a><li>
                                <li><a class="waves-effect" href="/oneUp/instructors/CalloutReport">Callout Report</a></li>
                                {% endif %}
                            </ul>
                        </div>
                    </li>
                    {% if ccparams.gamificationUsed %}
                    <li>
                        <a class="collapsible-header"><i class="material-icons">extension</i>Game Features</a>
                        <div class="collapsible-body">
                            <ul>
                                {% if ccparams.badgesUsed %}
                                <li><a class="dropdown-button" href="#!" data-constrainwidth="false" data-alignment="right" data-beloworigin="true" data-activates="badges-mobile">Badges<i class="material-icons right">more_vert</i></a></li>
                                {% endif %}
                                {% if ccparams.virtualCurrencyUsed %}            
                                <li><a class="dropdown-button" href="#!" data-constrainwidth="false" data-alignment="right" data-beloworigin="true" data-activates="virtualcurrency-mobile">Virtual Currency<i class="material-icons right">more_vert</i></a></li>
                                {% endif %}
                                {% if ccparams.leaderboardUsed %}    
                                <li><a class="waves-effect" href="/oneUp/instructors/dynamicLeaderboard">Leaderboards</a></li>  
                                {% endif %}     
			                    {% if ccparams.contentUnlockingDisplayed %}
                                <li><a class="waves-effect" href="/oneUp/badges/ProgressiveUnlocking">Content Unlocking</a></li>
                                {% endif %}
                                {% if ccparams.debugSystemVariablesDisplayed %}
                                <li><a class="waves-effect" href="/oneUp/instructors/debugSysVars">Debug System Variables</a></li>
				                {% endif %}
                                <li><a class="waves-effect" href="/oneUp/instructors/preferences">Gamification Configuration</a></li>
                            </ul>
                        </div>
                    </li>
		            {% endif %}
                    <li>
                        <a class="collapsible-header waves-effect" href="/oneUp/instructors/instructorQA"><i class="material-icons">help</i>Help</a>
                    </li>
                    <li>
                        <a class='collapsible-header mark-all' data-mark-action='read'><i class='material-icons'>notifications</i>Notifications  <div class='right'><span id='notification-count-mobile' class="new badge red"></span></div></a>
                        <div class='collapsible-body'>
                            <ul>
                                <div id="notifications-mobile" class="notification-box-list">
                                {% user_notifications for box %}
                                </div>			
                                <li><a class="clearAll waves-effect" href="#!"><i class="material-icons">clear_all</i>Clear All</a></li>					
                            </ul>
                        </div>
                    </li>
                    <li>
		                <a id='switchview' style="padding-left: 16px !important" class="collapsible-header waves-effect"  href="/oneUp/instructors/switchView?teacher=true&courseID={{courseId}}" >Switch to Student View
		                    <i class='material-icons'>visibility</i> 
		                </a>
		            </li>
                </ul>
            </li>
            {% if logged_in %}                        
            <li class="divider"></li>
            <li><a class="waves-effect" href="/oneUp/administrators/courses">Change Course</a></li>
            <li><a class="waves-effect" href="/oneUp/students/Logout">Logout</a></li>
            {% endif %}
        </ul>
        </div>
    </nav>
</header>

